<section class="px-6 py-20 bg-white">
  <div class="max-w-[1400px] mx-auto flex flex-col lg:flex-row gap-10">

    <!-- Left: Cart Table OR Empty Block -->
    <div class="flex-1 w-full">
      <div class="overflow-x-auto">

        @if (cartItems().length > 0) {
          <div>
            <div class="flex justify-end items-center mb-4">
              <button (click)="clearUserCart()"
                class="bg-pink-500 text-white text-sm rounded-[20px] py-3 px-6 hover:bg-pink-600 transition-colors shadow-lg flex items-center gap-2"
              >
                <i class="fas fa-trash-alt text-base"></i>
                Clear Cart
              </button>
            </div>
            <table class="w-full text-left border-separate border-spacing-x-6 border-spacing-y-4 min-w-[700px]">
              <thead class="text-gray-500 text-sm uppercase">
                <tr>
                  <th class="text-center font-medium">Image</th>
                  <th class="text-center font-medium">Product Name</th>
                  <th class="text-center font-medium">Price</th>
                  <th class="text-center font-medium">Quantity</th>
                  <th class="text-center font-medium">Price After Discount</th>
                  <th class="text-center font-medium">Delete</th>
                </tr>
              </thead>
              <tbody>
                @for (product of cartItems(); track product._id) {
                  <tr class="bg-white shadow-md rounded-xl">
                    <td class="p-0 text-center align-middle">
                      <div class="flex flex-col items-center justify-center h-full min-w-[80px]">
                        <img [src]="product.product.imgCover" alt="Product Image" class="w-20 h-20 object-cover rounded-[9px]" />
                      </div>
                    </td>
                    <td class="p-0 text-center align-middle">
                      <div class="font-semibold text-gray-800 text-base">{{ product.product.title.slice(0, 20) }}</div>
                      <div class="text-sm text-gray-500">Type: {{ product.product.description.slice(0, 15) }}</div>
                    </td>
                    <td class="p-0 text-center align-middle">
                      <span class="font-semibold text-gray-800 block">{{ product.product.price.toFixed(2) }}</span>
                    </td>
                    <td class="p-0 text-center align-middle">
                      <div class="flex items-center justify-center gap-2">
                        <button (click)="updateProductQuantity(product.product._id, product.quantity - 1)" [disabled]="product.quantity <= 1" class="w-7 h-7 rounded-[50%] bg-pink-100 text-pink-500 text-lg font-bold flex items-center justify-center  disabled:opacity-50 disabled:cursor-not-allowed">–</button>
                        <span class="font-medium text-gray-800">{{ product.quantity }}</span>
                        <button (click)="updateProductQuantity(product.product._id, product.quantity + 1)"  [disabled]="product.quantity >= product.product.quantity" class="w-7 h-7 rounded-[50%] bg-pink-100 text-pink-500 text-lg font-bold flex items-center justify-center  disabled:opacity-50 disabled:cursor-not-allowed">+</button>
                      </div>
                    </td>
                    <td class="p-0 text-center align-middle">
                      <span class="font-semibold text-gray-800 block">{{ product.product.priceAfterDiscount.toFixed(2) }}</span>
                    </td>
                    <td class="p-0 text-center align-middle">
                      <button (click)="removeProductFromCart(product.product._id)" class="text-gray-300 hover:text-red-400 text-xl block mx-auto">&times;</button>
                    </td>
                  </tr>
                }
              </tbody>
            </table>
          </div>

          <div class="flex items-center gap-4 mt-10 flex-wrap">
            <input 
              type="text"
              placeholder="Your Coupon Code"
              class="border border-gray-200 rounded-[15px] py-3 grow min-w-[250px] max-w-[400px] focus:outline-pink-300 focus:border-pink-300 px-4 text-sm transition-colors"
              style="box-shadow: inset 0 1px 2px 0 rgba(0,0,0,0.05);"
            />
            <button
              class="bg-pink-500 text-white text-sm rounded-[20px] py-3 px-6 hover:bg-pink-600 transition-colors"
            >
              Apply Coupon →
            </button>
            <button
              class="bg-pink-100 text-pink-500 text-sm rounded-[20px] py-3 px-6 hover:bg-pink-200 transition-colors"
            >
              ← Continue Shopping
            </button>
          </div>
        } @else {
      
          <div class="flex flex-col justify-center items-center min-h-[380px] py-20">
            <div class="text-7xl text-gray-300 mb-3">
              <i class="fas fa-shopping-cart"></i>
            </div>
            <div class="text-2xl font-bold text-gray-700 mb-2">
              Your cart is empty
            </div>
            <div class="text-sm text-gray-400 mb-4">
              Wanna try shopping?
            </div>
            <button
              class="bg-pink-500 text-white rounded-full py-2 px-7 text-sm hover:bg-pink-600 transition flex items-center gap-2"
              routerLink="/home"
            >
              <i class="fas fa-store"></i>
              Shop Now
            </button>
          </div>
        }

      </div>
    </div>


    <div class="w-full max-w-[330px] min-w-[240px] mx-auto lg:mx-0 bg-pink-50 rounded-[30px] p-7 flex flex-col justify-between h-fit"
         style="box-shadow:0 2px 16px 0 rgba(255,87,175,0.07)">
      <h2 class="text-lg font-bold text-gray-800 mb-6 text-center">Cart Summary</h2>
      <div class="space-y-4 text-gray-700 text-sm">
    
        <div class="flex justify-between text-pink-500 font-bold text-lg pt-4 border-t border-pink-100">
          <span>Total:</span>
          <span class="text-plack-500">{{totalCartItems()}}</span>
        </div>
      </div>
      <button routerLink="/shippingaddress" class="mt-6 w-full bg-pink-500 text-white rounded-xl py-3 font-medium hover:bg-pink-600 transition">
        Checkout Now →
      </button>
    </div>

    
  </div>
</section>
