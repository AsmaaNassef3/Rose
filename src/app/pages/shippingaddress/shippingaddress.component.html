<section class="py-20 bg-white">
  <div class="max-w-[1400px] mx-auto flex flex-col lg:flex-row gap-8">
    <!-- Left: 100% Width Stepper & Content -->
    <div class="flex-1 w-full min-w-0">
      <!-- PrimeNG-like stepper header -->
      <div class="w-full bg-white rounded-xl shadow border border-gray-100 p-6 mb-8">
        <div class="flex justify-between w-full">
          <!-- Step 1 -->
          <div class="flex flex-col items-center flex-1">
            <div [class]="step() === 1 
              ? 'bg-pink-600 text-white shadow-md' 
              : (step() > 1 ? 'bg-pink-100 text-pink-600 shadow-inner' : 'bg-gray-50 text-gray-400')"
              class="w-9 rounded-[50%] h-9 rounded-full flex items-center justify-center font-bold text-2xl border-2 border-pink-300/80 transition-all">
              1
            </div>
            <span class="mt-3 text-xs font-semibold text-gray-700 uppercase tracking-wider">Address</span>
          </div>
          <!-- Connector 1 -->
          <div class="flex-1 max-w-[80px] flex items-center -mx-8 z-10">
            <div [class]="step() >= 2 ? 'bg-pink-700/30' : 'bg-gray-200/50'" class="w-full h-1 rounded-full transition-colors"></div>
          </div>
   
          <div class="flex flex-col items-center flex-1">
            <div [class]="step() === 2 
              ? 'bg-pink-600 text-white shadow-md' 
              : (step() > 2 ? 'bg-pink-100 text-pink-600 shadow-inner' : 'bg-gray-50 text-gray-400')"
              class="w-9 rounded-[50%] h-9 rounded-full flex items-center justify-center font-bold text-2xl border-2 border-pink-300/80 transition-all">
              2
            </div>
            <span class="mt-3 text-xs font-semibold text-gray-700 uppercase tracking-wider">Payment</span>
          </div>

          <div class="flex-1 max-w-[80px] flex items-center -mx-8 z-10">
            <div [class]="step() >= 3 ? 'bg-pink-700/30' : 'bg-gray-200/50'" class="w-full h-1 rounded-full transition-colors"></div>
          </div>
     
          <div class="flex flex-col items-center flex-1">
            <div [class]="step() === 3 
              ? 'bg-pink-600 text-white shadow-md' 
              : (step() > 2 ? 'bg-pink-100 text-pink-600 shadow-inner' : 'bg-gray-50 text-gray-400')"
              class="w-9 rounded-[50%] h-9 rounded-full flex items-center justify-center font-bold text-2xl border-2 border-pink-300/80 transition-all">
              3
            </div>
            <span class="mt-3 text-xs font-semibold text-gray-700 uppercase tracking-wider">Confirmation</span>
          </div>
        </div>
      </div>

   
      <div class="w-full">
        @if (step() === 1) {
          <div class="bg-white rounded-xl shadow border border-gray-100 p-8 mb-8">
            @if (totalUserAddresses()?.length) {
              <div class="flex flex-col gap-4">
                @for (address of totalUserAddresses(); track address._id) {
      <div  (click)="selectAddress(address)" [class.border-pink-500]="selectedAddress?._id === address._id" class="rounded-xl bg-gray-50 p-4 flex items-center border border-gray-300 shadow-sm transition hover:shadow-lg hover:border-pink-400">
  <!-- User Icon -->
  <div class="flex items-center justify-center w-12 h-12 rounded-full bg-gray-200 mr-4">
    <i class="fas fa-user text-gray-500 text-2xl"></i>
  </div>
  <div class="flex-1">
    <div class="font-bold text-base mb-1 text-gray-800 flex items-center gap-2">
      {{ address.username }}
    </div>
    <div class="text-sm mb-1 text-gray-600 flex items-center gap-2">
      <i class="fas fa-city text-pink-400"></i>
      {{ address.city }}
    </div>
    <div class="text-sm mb-1 text-gray-600 flex items-center gap-2">
      <i class="fas fa-road text-pink-400"></i>
      {{ address.street }}
    </div>
    <div class="flex items-center gap-2 text-sm text-gray-500">
      <i class="fas fa-phone-alt text-pink-400"></i>
      <span>{{ address.phone }}</span>
    </div>
  </div>
  <!-- Remove Icon Button -->
  <button (click)="removeAddress(address._id)" class="ml-4 bg-gray-100 hover:bg-pink-100 text-pink-600 rounded-full p-2 transition shadow">
    <i class="fas fa-trash-alt"></i>
  </button>
</div>
                }
              </div>
       
                 <button onclick="my_modal_4.showModal()" class="bg-pink-600 text-white rounded-xl px-8 py-3 hover:bg-pink-700 transition flex items-center gap-2 shadow-md">
                  <i class="fas fa-plus"></i> Add New Address
                </button>
              
            } @else {
              <div class="rounded-xl bg-pink-50 flex flex-col items-center justify-center py-16 shadow-inner">
                <i class="fas fa-map-marker-alt text-6xl text-pink-400 mb-2"></i>
                <div class="font-bold text-lg mb-2 text-pink-700">No Addresses Found!</div>
                <div class="text-gray-500 mb-4 text-center text-sm">Add your first shipping address now.</div>
                <button onclick="my_modal_4.showModal()" class="bg-pink-600 text-white rounded-xl px-8 py-3 hover:bg-pink-700 transition flex items-center gap-2 shadow-md">
                  <i class="fas fa-plus"></i> Add New Address
                </button>
              </div>
            }
            <div class="flex justify-end mt-6">
              <button (click)="step.set(2)" class="bg-pink-600 text-white rounded-xl px-8 py-3 hover:bg-pink-700 transition flex items-center gap-2 font-semibold shadow-md">
                Next <i class="fas fa-arrow-right"></i>
              </button>
            </div>
          </div>
        }
        @else if (step() === 2) {
          <div class="bg-white rounded-xl shadow border border-gray-100 p-8 mb-8">
            <div class="grid gap-4">
          <button 
  type="button" 
  (click)="cashOrder()" 
  class="w-full text-left flex items-center gap-4 rounded-xl border border-gray-300 py-4 px-6 hover:bg-pink-50/50 transition cursor-pointer"
>
  <i class="fas fa-money-bill-wave text-2xl text-pink-600"></i>
  <span class="font-semibold text-gray-800">Cash on Delivery</span>
</button>

              <div class="flex items-center gap-4 rounded-xl border border-gray-300 py-4 px-6 hover:bg-pink-50/50 transition cursor-pointer">
                   <button 
  type="button" 
  (click)="checkOutOrder()" 
  class="w-full text-left flex items-center gap-4 rounded-xl border border-gray-300 py-4 px-6 hover:bg-pink-50/50 transition cursor-pointer"
>
  <i class="fas fa-money-bill-wave text-2xl text-pink-600"></i>
  <span class="font-semibold text-gray-800">Bank Transfer</span>
</button>
              </div>
            </div>
            <div class="flex justify-between mt-8">
              <button (click)="step.set(1)" class="bg-white text-gray-700 hover:bg-gray-100 border border-gray-300 rounded-xl px-8 py-3 transition flex items-center gap-2 font-semibold">
                <i class="fas fa-arrow-left"></i> Back
              </button>
              <button (click)="step.set(3)" class="bg-pink-600 text-white rounded-xl px-8 py-3 hover:bg-pink-700 transition flex items-center gap-2 font-semibold shadow-md">
                Next <i class="fas fa-arrow-right"></i>
              </button>
            </div>
          </div>
        }
        @else if (step() === 3) {
          <div class="bg-white rounded-xl shadow border border-gray-100 p-8 mb-8">
            <div class="rounded-xl bg-pink-50 flex flex-col items-center justify-center py-16">
              <i class="fas fa-check-circle text-7xl text-pink-600 mb-3"></i>
              <h3 class="font-bold text-xl mb-2 text-pink-700">Thank You!</h3>
              <p class="text-gray-600 mb-4 text-center">
                Your order has been placed successfully.<br>
                Please await your confirmation code.
              </p>
            </div>
            <div class="flex justify-start mt-8">
              <button (click)="step.set(2)" class="bg-white text-gray-700 hover:bg-gray-100 border border-gray-300 rounded-xl px-8 py-3 transition flex items-center gap-2 font-semibold">
                <i class="fas fa-arrow-left"></i> Back
              </button>
            </div>
          </div>
        }
      </div>
    </div>
    <div class="w-full max-w-[330px] min-w-[220px] mx-auto lg:mx-0 bg-pink-50 rounded-[28px] p-7 flex flex-col justify-between h-fit shadow-sm" style="box-shadow:0 2px 16px 0 rgba(255,87,175,0.07)">
      <h2 class="text-lg font-bold text-gray-800 mb-6 text-center">Cart Summary</h2>
      <div class="space-y-4 text-gray-700 text-sm">
        <div class="flex justify-between text-pink-500 font-bold text-lg pt-4 border-t border-pink-100">
          <span>Total:</span>
          <span>{{totalCartItems()}}</span>
        </div>
      </div>
      <button routerLink="/shippingaddress" class="mt-6 w-full bg-pink-600 text-white rounded-xl py-3 font-medium hover:bg-pink-700 transition">
        Next <i class="fas fa-arrow-right ml-2"></i>
      </button>
    </div>
  </div>
        <app-modal></app-modal>
</section>
